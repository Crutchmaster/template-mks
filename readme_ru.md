# rmq-template - шаблон для микросервиса

## Сборка
Ставим maven, делаем
```
mvn package
```
jar файл собирётся в /target.

## Запуск
```
java -jar mks-template.jar --amqp_host=<адрес amqp сервера> --amqp_user=<amqp пользователь> --apqp_password=<amqp пароль> --name=<название микросервиса>
```
Название микросервиса - любая строка на выбор без пробелов и спецсимволов.

## Работа
После запуска микросервис создаст 3 очереди в rabbitmq:

app_log - сюда должны сбрасываться логи приложения. Сейчас логи и исходящие сообщения.

app_out - сюда сбрасываются выходные данные.

app_control - отсюда приложение получает команды.

где app - это название микросервиса. В целом - те же самые стандартные потоки, вид с боку.

Микросервис ждет сообщение содержащее json вида 
```
{"команда" : ["параметр 1","параметр 2" ...]}
```
в очереди app_control

## Команды
getCommands (без параметров)
```
{"getCommands":[]}
```
Выдает на app_out (и пока в app_log) json со списком команд.
```
{"commands":["cmd1","cmd2"...]}
```
ping - возвращает pong

test1, test2, test3 - тесты вызова метода с параметрами
```
{"test3":["1","1.5","true"]}
```
Параметры test1, test2 одна и две строки соответсвенно. test3 - целое число, число с плав.точкой и логическое. Возвращают переданные параметры. Если не удалось что-то распарсить или параметров не хватает информируют об этом.

setControlQueue, setLogQueue, setOutQueue меняют очередь для входных данных, логов и выходных данных соотвественно.

Посмотреть как работает этот микросервис можно через веб интерфейс rabbitmq (порт 15672).
